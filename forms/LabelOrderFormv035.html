<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Label Order Form</title>
  <style>
    body {
      font-family: Calibri, sans-serif;
      margin: 0;
      padding: 20px;
      font-size: 0.875rem; /* main font size */
    }
    /* Form Title */
    h3.form-title {
      margin: 0 0 20px;
      font-size: 1.25rem;
      text-align: center;
    }
    /* Upper part responsive container */
    .upper-form {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    .upper-form .section {
      flex: 1 1 300px;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      margin-bottom: 10px;
    }
    .form-group label {
      margin: 0 0 2px 0; /* top margin 0, bottom margin 2px */
      font-weight: normal;
      font-size: 0.75rem;
    }
    /* New Ship Via Section */
    .ship-via {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .ship-via-group {
      display: flex;
      flex-direction: column;
      flex: 1 1 150px;
    }
    .ship-via-group label {
      margin: 0 0 2px 0;
      font-weight: normal;
      font-size: 0.75rem;
      text-align: left;
    }
    .ship-via-group select,
    .ship-via-group input[type="text"] {
      font-family: inherit;
      font-size: inherit;
      padding: 4px;
      border: 1px solid #ccc;
      border-radius: 0;
      box-sizing: border-box;
    }
    /* Dynamic Rows Section (Product Information) */
    .form-header,
    .form-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      align-items: flex-start; /* Top align all items */
    }
    .quote-header,
    .quantity-header,
    .units-header,
    .price-header {
      width: 10ch;
      text-align: center;
    }
    .product-description {
      flex: 1;
      text-align: center;
    }
    .alt-bg {
      background-color: #f0f0f0;
    }
    textarea, input[type="text"], input[type="date"], input[type="number"] {
      font-family: inherit;
      font-size: inherit;
      padding: 4px;
      border: 1px solid #ccc;
      border-radius: 0;
      box-sizing: border-box;
    }
    textarea {
      resize: none;
      overflow: hidden;
      min-height: 1.5em;
      line-height: 1.2em;
      margin: 0;
    }
    /* Styling for the Price per Unit container */
    .price-container {
      display: flex;
      align-items: flex-start;
      width: 10ch;
    }
    .price-container span {
      display: inline-block;
      width: 1ch;
      margin-right: 2px;
      white-space: nowrap;
    }
    .price-container input {
      width: calc(100% - 1ch);
      flex: 1;
    }
    /* Notes / Special Instructions */
    .notes-container {
      display: flex;
      flex-direction: column;
      margin: 15px 0;
      width: 100%;
    }
    .notes-container label {
      margin: 0 0 2px 0;
      font-weight: normal;
      font-size: 0.75rem;
    }
    .notes-container textarea {
      width: 100%;
      resize: vertical;
      padding: 4px;
      border: 1px solid #ccc;
      border-radius: 0;
      box-sizing: border-box;
      font-family: inherit;
      font-size: inherit;
      line-height: 1.2em;
    }
    /* Order Submitted by */
    .order-submitted {
      display: flex;
      flex-direction: column;
      margin-bottom: 15px;
      width: 100%;
    }
    .order-submitted label {
      margin: 0 0 2px 0;
      font-weight: normal;
      font-size: 0.75rem;
    }
    .order-submitted input[type="text"] {
      width: 100%;
      padding: 4px;
      border: 1px solid #ccc;
      border-radius: 0;
      box-sizing: border-box;
      font-family: inherit;
      font-size: inherit;
    }
    /* Additional Charges Section */
    h3.additional-charges-title {
      margin: 20px 0 10px;
      font-size: 1.125rem;
      text-align: left;  /* aligned to left */
    }
    /* Dynamic Rows Section (Additional Charges) */
    .charge-header,
    .charge-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      align-items: flex-start;
    }
    .charge-quote,
    .charge-quantity,
    .charge-units,
    .charge-price {
      width: 10ch;
      text-align: center;
    }
    .charge-description {
      flex: 1;
      text-align: center;
    }
    /* Change header label for Additional Charges Description */
    .charge-description::before {
      content: "Description";
    }
    .charge-description {
      display: flex;
      justify-content: center;
    }
    button {
      font-family: inherit;
      font-size: inherit;
      padding: 6px 12px;
      margin-right: 5px;
    }
    /* Current DateTime element */
    #currentDateTime {
      position: fixed;
      bottom: 10px;
      right: 10px;
      font-size: 0.75rem;
      text-align: right;
    }
    @media print {
      button {
        display: none;
      }
      .upper-form {
        flex-wrap: nowrap;
        gap: 10px;
      }
      .upper-form .section {
        flex: 1 1 33.33%;
      }
      .ship-via {
        flex-wrap: nowrap;
        gap: 10px;
      }
      .ship-via-group {
        flex: 1 1 25%;
      }
      #currentDateTime {
        position: fixed;
        bottom: 10px;
        right: 10px;
      }
      /* Hide placeholder text when printing */
      ::-webkit-input-placeholder { color: transparent !important; }
      ::-moz-placeholder { color: transparent !important; }
      :-ms-input-placeholder { color: transparent !important; }
      ::placeholder { color: transparent !important; }
    }
  </style>
</head>
<body>
  <!-- Form Title -->
  <h3 class="form-title">Label Order Form</h3>
  
  <!-- Upper Responsive Section -->
  <div class="upper-form">
    <!-- 1st Section: PO #, Order Date, Requested Ship Date, Order Type -->
    <div class="section">
      <div class="form-group">
        <label for="textone">PO #</label>
        <input type="text" id="textone" name="textone" placeholder="PO #" />
      </div>
      <div class="form-group">
        <label for="date1">Order Date</label>
        <input type="date" id="date1" name="date1" placeholder="Order Date" />
      </div>
      <div class="form-group">
        <label for="shipDate">Requested Ship Date</label>
        <input type="date" id="shipDate" name="shipDate" placeholder="Requested Ship Date" />
      </div>
      <div class="form-group">
        <label for="orderType">Order Type</label>
        <select id="orderType" name="orderType">
          <option value="New">New</option>
          <option value="Exact Repeat">Exact Repeat</option>
          <option value="Changed Repeat">Changed Repeat</option>
        </select>
      </div>
    </div>
    <!-- 2nd Section: Customer/Bill To, Customer Contact, Customer Account # -->
    <div class="section">
      <div class="form-group">
        <label for="textarea1">Customer/Bill To</label>
        <textarea id="textarea1" name="textarea1" placeholder="Company Name&#10;Address 1&#10;Address 2&#10;City, State Zip" rows="4"></textarea>
      </div>
      <div class="form-group">
        <label for="textarea_contact">Customer Contact</label>
        <textarea id="textarea_contact" name="textarea_contact" placeholder="Name&#10;Email&#10;Phone" rows="3"></textarea>
      </div>
      <div class="form-group">
        <label for="customerAccount">Customer Account #</label>
        <input type="text" id="customerAccount" name="customerAccount" placeholder="Enter account #" />
      </div>
    </div>
    <!-- 3rd Section: Ship To, Ship To Contact -->
    <div class="section">
      <div class="form-group">
        <label for="textarea_shipto">Ship To</label>
        <textarea id="textarea_shipto" name="textarea_shipto" placeholder="Company Name&#10;Address 1&#10;Address 2&#10;City, State Zip" rows="4"></textarea>
      </div>
      <div class="form-group">
        <label for="textarea_shipto_contact">Ship To Contact</label>
        <textarea id="textarea_shipto_contact" name="textarea_shipto_contact" placeholder="Name&#10;Email&#10;Phone" rows="3"></textarea>
      </div>
    </div>
  </div>
  
  <!-- Ship Via Section -->
  <div class="ship-via">
    <div class="ship-via-group">
      <label for="shipViaCarrier">Ship Via Carrier</label>
      <select id="shipViaCarrier" name="shipViaCarrier">
        <option value="Best Way">Best Way</option>
        <option value="UPS">UPS</option>
        <option value="FedEx">FedEx</option>
        <option value="Truck">Truck</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <div class="ship-via-group">
      <label for="service">Service</label>
      <select id="service" name="service">
        <option value="Standard">Standard</option>
        <option value="Ground">Ground</option>
        <option value="2nd Day Air">2nd Day Air</option>
        <option value="Next Day Air">Next Day Air</option>
        <option value="Next Day Air Early">Next Day Air Early</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <div class="ship-via-group">
      <label for="terms">Terms</label>
      <select id="terms" name="terms">
        <option value="Prepaid and Add">Prepaid and Add</option>
        <option value="Collect">Collect</option>
        <option value="Third Party">Third Party</option>
        <option value="No Charge">No Charge</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <div class="ship-via-group">
      <label for="account">Account #</label>
      <input type="text" id="account" name="account" placeholder="Account #" />
    </div>
  </div>
  
  <!-- Dynamic Rows Section: Product Information -->
  <h3>Product Information</h3>
  <div class="form-header">
    <div class="quote-header">Quote #</div>
    <div class="product-description">Product Description</div>
    <div class="quantity-header">Quantity</div>
    <div class="units-header">Units</div>
    <div class="price-header">Price per Unit</div>
  </div>
  
  <form id="myForm">
    <div id="formContainer"></div>
    <button type="button" onclick="addFields()">Add Row</button>
    
    <!-- Dynamic Rows Section: Additional Charges -->
    <h3 class="additional-charges-title">Additional Charges</h3>
    <div class="form-header">
      <div class="quote-header">Quote #</div>
      <div class="product-description">Description</div>
      <div class="quantity-header">Quantity</div>
      <div class="units-header">Units</div>
      <div class="price-header">Price per Unit</div>
    </div>
    <div id="additionalChargesContainer"></div>
    <button type="button" onclick="addChargeFields()">Add Row</button>
    
    <!-- Notes / Special Instructions Field -->
    <div class="notes-container">
      <label for="textarea2">Notes / Special Instructions</label>
      <textarea id="textarea2" name="textarea2" rows="2"></textarea>
    </div>
    <!-- Order Submitted by Field -->
    <div class="order-submitted">
      <label for="orderSubmittedBy">Order Submitted by</label>
      <input type="text" id="orderSubmittedBy" name="orderSubmittedBy" placeholder="Name" />
    </div>
    <button type="button" onclick="manualSave()">Save Progress</button>
    <button type="button" onclick="downloadForm()">Save File</button>
    <button type="button" onclick="printPage()">Print</button>
    <button type="button" onclick="emailForm()">Email</button>
    <button type="button" onclick="clearForm()" style="margin-left: 30px;">Clear Form</button>
  </form>
  
  <!-- Current Date and Time -->
  <div id="currentDateTime"></div>
  
  <script id="embeddedFormData" type="application/json"></script>
  <script>
    let count = 0, chargeCount = 0;
    
    function autoResize() {
      this.style.height = 'auto';
      this.style.height = this.scrollHeight + 'px';
    }
    
    // Update row height (common function)
    function updateRowHeight(row) {
      const quantityInput = row.querySelector('input[name^="quantity_"]') || row.querySelector('input[name^="chargeQuantity_"]');
      if (quantityInput) {
        const h = quantityInput.offsetHeight;
        const quote = row.querySelector('textarea[name^="field1_"]') || row.querySelector('textarea[name^="chargeField1_"]');
        const product = row.querySelector('textarea[name^="field2_"]') || row.querySelector('textarea[name^="chargeField2_"]');
        const units = row.querySelector('input[name^="units_"]') || row.querySelector('input[name^="chargeUnits_"]');
        const priceInput = row.querySelector('input[name^="price_"]') || row.querySelector('input[name^="chargePrice_"]');
        if (quote) { quote.style.height = h + 'px'; }
        if (product) { product.style.height = h + 'px'; }
        if (units) { units.style.height = h + 'px'; }
        if (priceInput) { priceInput.style.height = h + 'px'; }
      }
    }
    
    function updateDynamicRowHeights() {
      const rows = document.querySelectorAll('#formContainer .form-row');
      rows.forEach(row => updateRowHeight(row));
    }
    
    function updateAdditionalChargeHeights() {
      const rows = document.querySelectorAll('#additionalChargesContainer .form-row');
      rows.forEach(row => updateRowHeight(row));
    }
    
    // Function for Product Information dynamic rows
    function addFields() {
      count++;
      const container = document.getElementById('formContainer');
      const div = document.createElement('div');
      div.className = 'form-row';
      const useAltBg = count % 2 === 0;
      
      // Quote #
      const quoteTextarea = createAutoGrowTextarea(`field1_${count}`, useAltBg);
      quoteTextarea.style.width = "10ch";
      
      // Product Description
      const productTextarea = createAutoGrowTextarea(`field2_${count}`, useAltBg);
      productTextarea.classList.add("product-description");
      productTextarea.style.textAlign = "left";
      
      // Quantity
      const quantityInput = document.createElement('input');
      quantityInput.type = 'number';
      quantityInput.name = `quantity_${count}`;
      quantityInput.placeholder = '-';
      quantityInput.style.textAlign = 'right';
      quantityInput.style.width = "10ch";
      if (useAltBg) { quantityInput.classList.add('alt-bg'); }
      quantityInput.addEventListener('input', autoSave);
      
      // Units
      const unitsInput = document.createElement('input');
      unitsInput.type = 'text';
      unitsInput.name = `units_${count}`;
      unitsInput.placeholder = '-';
      unitsInput.style.width = "10ch";
      if (useAltBg) { unitsInput.classList.add('alt-bg'); }
      unitsInput.addEventListener('input', autoSave);
      
      // Price per Unit
      const priceContainer = document.createElement('div');
      priceContainer.className = 'price-container';
      priceContainer.style.width = "10ch";
      const dollarSpan = document.createElement('span');
      dollarSpan.textContent = '$';
      const priceInput = document.createElement('input');
      priceInput.type = 'number';
      priceInput.name = `price_${count}`;
      priceInput.placeholder = '-';
      priceInput.step = "0.00001";
      priceInput.style.textAlign = 'right';
      priceInput.style.flex = "1";
      if (useAltBg) { priceInput.classList.add('alt-bg'); }
      priceInput.addEventListener('input', autoSave);
      priceInput.addEventListener('blur', function() {
        if(this.value !== '') {
          let num = parseFloat(this.value);
          let parts = this.value.split('.');
          let decCount = parts.length > 1 ? parts[1].length : 0;
          if(decCount < 2) {
            this.value = num.toFixed(2);
          } else if(decCount > 5) {
            this.value = num.toFixed(5);
          } else {
            this.value = num.toFixed(decCount);
          }
          autoSave();
        }
      });
      priceContainer.appendChild(dollarSpan);
      priceContainer.appendChild(priceInput);
      
      div.appendChild(quoteTextarea);
      div.appendChild(productTextarea);
      div.appendChild(quantityInput);
      div.appendChild(unitsInput);
      div.appendChild(priceContainer);
      container.appendChild(div);
      updateRowHeight(div);
    }
    
    // Function for Additional Charges dynamic rows
    function addChargeFields() {
      chargeCount++;
      const container = document.getElementById('additionalChargesContainer');
      const div = document.createElement('div');
      div.className = 'form-row';
      const useAltBg = chargeCount % 2 === 0;
      
      // Quote #
      const quoteTextarea = createAutoGrowTextarea(`chargeField1_${chargeCount}`, useAltBg);
      quoteTextarea.style.width = "10ch";
      
      // Product Description (will display header "Description")
      const productTextarea = createAutoGrowTextarea(`chargeField2_${chargeCount}`, useAltBg);
      productTextarea.classList.add("product-description");
      productTextarea.style.textAlign = "left";
      
      // Quantity
      const quantityInput = document.createElement('input');
      quantityInput.type = 'number';
      quantityInput.name = `chargeQuantity_${chargeCount}`;
      quantityInput.placeholder = '-';
      quantityInput.style.textAlign = 'right';
      quantityInput.style.width = "10ch";
      if (useAltBg) { quantityInput.classList.add('alt-bg'); }
      quantityInput.addEventListener('input', autoSave);
      
      // Units
      const unitsInput = document.createElement('input');
      unitsInput.type = 'text';
      unitsInput.name = `chargeUnits_${chargeCount}`;
      unitsInput.placeholder = '-';
      unitsInput.style.width = "10ch";
      if (useAltBg) { unitsInput.classList.add('alt-bg'); }
      unitsInput.addEventListener('input', autoSave);
      
      // Price per Unit
      const priceContainer = document.createElement('div');
      priceContainer.className = 'price-container';
      priceContainer.style.width = "10ch";
      const dollarSpan = document.createElement('span');
      dollarSpan.textContent = '$';
      const priceInput = document.createElement('input');
      priceInput.type = 'number';
      priceInput.name = `chargePrice_${chargeCount}`;
      priceInput.placeholder = '-';
      priceInput.step = "0.00001";
      priceInput.style.textAlign = 'right';
      priceInput.style.flex = "1";
      if (useAltBg) { priceInput.classList.add('alt-bg'); }
      priceInput.addEventListener('input', autoSave);
      priceInput.addEventListener('blur', function() {
        if(this.value !== '') {
          let num = parseFloat(this.value);
          let parts = this.value.split('.');
          let decCount = parts.length > 1 ? parts[1].length : 0;
          if(decCount < 2) {
            this.value = num.toFixed(2);
          } else if(decCount > 5) {
            this.value = num.toFixed(5);
          } else {
            this.value = num.toFixed(decCount);
          }
          autoSave();
        }
      });
      priceContainer.appendChild(dollarSpan);
      priceContainer.appendChild(priceInput);
      
      div.appendChild(quoteTextarea);
      div.appendChild(productTextarea);
      div.appendChild(quantityInput);
      div.appendChild(unitsInput);
      div.appendChild(priceContainer);
      container.appendChild(div);
      updateRowHeight(div);
    }
    
    function createAutoGrowTextarea(name, altBg) {
      const textarea = document.createElement('textarea');
      textarea.name = name;
      textarea.placeholder = '-';
      textarea.rows = 1;
      if (altBg) { textarea.classList.add('alt-bg'); }
      textarea.addEventListener('input', autoResize);
      textarea.addEventListener('input', autoSave);
      autoResize.call(textarea);
      return textarea;
    }
    
    function autoSave() {
      const data = {};
      document.querySelectorAll('textarea, input[type="text"], input[type="date"], input[type="number"], select, input[type="checkbox"]').forEach(input => {
        if (input.type === 'checkbox') {
          data[input.name] = input.checked;
        } else {
          data[input.name] = input.value;
        }
      });
      localStorage.setItem('myFormData', JSON.stringify(data));
    }
    
    function manualSave() {
      autoSave();
    }
    
    function updateCurrentDateTime() {
      const now = new Date();
      document.getElementById('currentDateTime').innerText = now.toLocaleString();
    }
    
    function loadSavedData() {
      let saved;
      const embedded = document.getElementById('embeddedFormData');
      if (embedded && embedded.textContent.trim()) {
        try {
          saved = JSON.parse(embedded.textContent);
          localStorage.setItem('myFormData', embedded.textContent);
        } catch (e) {
          console.error("Invalid embedded data", e);
          saved = {};
        }
      } else {
        saved = JSON.parse(localStorage.getItem('myFormData') || '{}');
      }
    
      const textone = document.getElementById('textone');
      const date1 = document.getElementById('date1');
      const shipDate = document.getElementById('shipDate');
      const textarea1 = document.getElementById('textarea1');
      const textarea_contact = document.getElementById('textarea_contact');
      const textarea_shipto = document.getElementById('textarea_shipto');
      const textarea_shipto_contact = document.getElementById('textarea_shipto_contact');
      const textarea2 = document.getElementById('textarea2');
      const orderSubmittedBy = document.getElementById('orderSubmittedBy');
    
      textone.addEventListener('input', autoSave);
      date1.addEventListener('input', autoSave);
      shipDate.addEventListener('input', autoSave);
      textarea1.addEventListener('input', autoResize);
      textarea1.addEventListener('input', autoSave);
      textarea_contact.addEventListener('input', autoResize);
      textarea_contact.addEventListener('input', autoSave);
      textarea_shipto.addEventListener('input', autoResize);
      textarea_shipto.addEventListener('input', autoSave);
      textarea_shipto_contact.addEventListener('input', autoResize);
      textarea_shipto_contact.addEventListener('input', autoSave);
      textarea2.addEventListener('input', autoResize);
      textarea2.addEventListener('input', autoSave);
      orderSubmittedBy.addEventListener('input', autoSave);
    
      if (saved['textone']) textone.value = saved['textone'];
      if (saved['date1']) date1.value = saved['date1'];
      if (saved['shipDate']) shipDate.value = saved['shipDate'];
      if (saved['textarea1']) textarea1.value = saved['textarea1'];
      if (saved['textarea_contact']) textarea_contact.value = saved['textarea_contact'];
      if (saved['textarea_shipto']) textarea_shipto.value = saved['textarea_shipto'];
      if (saved['textarea_shipto_contact']) textarea_shipto_contact.value = saved['textarea_shipto_contact'];
      if (saved['textarea2']) textarea2.value = saved['textarea2'];
      if (saved['orderSubmittedBy']) orderSubmittedBy.value = saved['orderSubmittedBy'];
    
      autoResize.call(textarea1);
      autoResize.call(textarea_contact);
      autoResize.call(textarea_shipto);
      autoResize.call(textarea_shipto_contact);
      autoResize.call(textarea2);
    
      // Load dynamic rows for Product Information
      const keys = Object.keys(saved);
      const rowIndexes = new Set(
        keys.filter(k =>
          k.startsWith('field1_') ||
          k.startsWith('field2_') ||
          k.startsWith('quantity_') ||
          k.startsWith('units_') ||
          k.startsWith('price_')
        ).map(k => k.match(/\d+$/)?.[0])
      );
      if (rowIndexes.size > 0) {
        for (let i = 0; i < rowIndexes.size; i++) addFields();
        document.querySelectorAll('#formContainer textarea, #formContainer input').forEach(input => {
          if (saved[input.name] !== undefined) {
            input.value = saved[input.name];
            input.dispatchEvent(new Event('input'));
          }
        });
      } else {
        addFields();
      }
    
      // Load dynamic rows for Additional Charges
      const chargeKeys = new Set(
        keys.filter(k =>
          k.startsWith('chargeField1_') ||
          k.startsWith('chargeField2_') ||
          k.startsWith('chargeQuantity_') ||
          k.startsWith('chargeUnits_') ||
          k.startsWith('chargePrice_')
        ).map(k => k.match(/\d+$/)?.[0])
      );
      if (chargeKeys.size > 0) {
        for (let i = 0; i < chargeKeys.size; i++) addChargeFields();
        document.querySelectorAll('#additionalChargesContainer textarea, #additionalChargesContainer input').forEach(input => {
          if (saved[input.name] !== undefined) {
            input.value = saved[input.name];
            input.dispatchEvent(new Event('input'));
          }
        });
      }
      updateDynamicRowHeights();
      updateAdditionalChargeHeights();
      updateCurrentDateTime();
    }
    
    function clearForm() {
      if (confirm("Are you sure you want to clear the form?")) {
        localStorage.removeItem('myFormData');
        window.location.href = window.location.href;
      }
    }
    
    function printPage() {
      window.print();
    }
    
    function emailForm() {
      const inputs = document.querySelectorAll('textarea, #formContainer input, #additionalChargesContainer input, #additionalChargesContainer textarea, .upper-form input, .upper-form select, .ship-via input, .ship-via select, .order-submitted input, #currentDateTime');
      let body = 'Here is the form data:\n\n';
      inputs.forEach(input => {
        body += `${input.name}: ${input.value}\n`;
      });
      const currentDateTime = document.getElementById('currentDateTime').innerText;
      body += `CurrentDateTime: ${currentDateTime}\n`;
      window.location.href = `mailto:?subject=Form Data&body=${encodeURIComponent(body)}`;
    }
    
    function downloadForm() {
      autoSave();
      const saved = localStorage.getItem('myFormData') || '{}';
      const embedded = document.getElementById('embeddedFormData');
      embedded.textContent = saved;
      const html = '<!DOCTYPE html>' + document.documentElement.outerHTML;
      const blob = new Blob([html], { type: 'text/html' });
      const now = new Date();
      const pad = n => n.toString().padStart(2, '0');
      const fileName = `FunctionalForm_${now.getFullYear()}${pad(now.getMonth() + 1)}${pad(now.getDate())}${pad(now.getHours())}${pad(now.getMinutes())}.html`;
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }
    
    function updateCurrentDateTime() {
      const now = new Date();
      document.getElementById('currentDateTime').innerText = now.toLocaleString();
    }
    
    window.onload = loadSavedData;
  </script>
</body>
</html>
