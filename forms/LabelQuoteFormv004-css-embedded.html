<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Label Quote Form</title>
  <style>
    /* Default Sans-Serif Font Styles */
    body {
      font-family: sans-serif;
    }

    /* Form-specific styles */
    body {
      margin: 0;
      padding: 20px;
      font-size: 1rem;
    }

    /* Labels and layout */
    .form-group {
      display: flex;
      flex-direction: column;
      margin-bottom: 10px;
    }

    .form-group label {
      margin: 0 0 2px 0;
      font-weight: normal;
      font-size: 1rem;
    }

    /* Inputs */
    input[type="text"],
    input[type="number"],
    input[type="file"],
    select,
    textarea {
      font-family: inherit;
      font-size: 1rem;
      padding: 4px;
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 0;
      box-sizing: border-box;
    }

    textarea {
      resize: vertical;
      line-height: 1.2em;
    }

    /* Title */
    h5.form-title {
      margin: 0 0 20px;
      font-size: 1.375rem;
      text-align: center;
    }

    /* Responsive sections container */
    .upper-form {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 8px;
    }

    .upper-form .section {
      flex: 1 1 300px;
    }

    /* Full-width section for Description */
    .upper-form .section-wide {
      flex: 1 1 100%;
      width: 100%;
      max-width: 100%;
    }

    /* Quantities to Quote layout */
    .quantities-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .quantities-grid input[type="number"] {
      width: 10ch;
      text-align: right;
    }

    .form-divider {
      width: 100%;
      margin: 20px 0;
      border: none;
      border-top: 1px solid #ccc;
    }

    .notes-section {
      width: 100%;
      padding: 0 0 10px 0;
    }

    .form-note {
      font-size: 0.875rem;
      font-style: italic;
      margin: 4px 0 10px;
    }

    /* Buttons */
    button {
      font-family: inherit;
      font-size: 1rem;
      padding: 6px 12px;
      margin-right: 5px;
    }

    /* Subsection titles */
    h6.section-title {
      margin: 4px 0 2px;
      font-size: 1.25rem;
      font-weight: normal;
    }

    @media print {
      button { display: none; }
      ::-webkit-input-placeholder { color: transparent !important; }
      ::-moz-placeholder { color: transparent !important; }
      :-ms-input-placeholder { color: transparent !important; }
      ::placeholder { color: transparent !important; }
    }
  </style>
</head>
<body>
  <h5 class="form-title">Label Quote Form</h5>

  <form id="quoteForm" action="#" method="post">
    <div class="upper-form">
      <!-- Section: Description (full width) -->
      <div class="section section-wide">
        <div class="form-group">
          <label for="description">Description</label>
          <input type="text" id="description" name="description" />
        </div>
      </div>
      <!-- Section: Shape -->
      <div class="section">
        <h6 class="section-title">Shape</h6>
        <div class="form-group">
          <label for="label-shape">Label Shape</label>
          <select id="label-shape" name="label-shape">
            <option value="rectangle">Rectangle</option>
            <option value="circle">Circle</option>
            <option value="oval">Oval</option>
            <option value="special">Special</option>
          </select>
        </div>
        <div class="form-group" id="corners-group">
          <label for="corners">Corners*</label>
          <select id="corners" name="corners">
            <option value="rounded">Rounded</option>
            <option value="square">Square</option>
          </select>
        </div>
      </div>

      <!-- Section: Size -->
      <div class="section">
        <h6 class="section-title">Size</h6>
        <div class="form-group">
          <label for="cutting-die">Label Size Type</label>
          <select id="cutting-die" name="cutting-die">
            <option value="existing-die-size">Existing Die Size</option>
            <option value="custom-die-size">Custom Die Size</option>
          </select>
        </div>
        <div class="form-group" id="existing-die-size-group">
          <label for="existing-die-size">Existing Die Size*</label>
          <select id="existing-die-size" name="existing-die-size">
            <option value="">Select a size...</option>
            <option value="2.000x1.000">2.000" x 1.000"</option>
            <option value="3.000x2.000">3.000" x 2.000"</option>
            <option value="4.000x6.000">4.000" x 6.000"</option>
            <option value="1.500x1.500">1.500" x 1.500"</option>
            <option value="2.500x3.500">2.500" x 3.500"</option>
          </select>
        </div>
        <div class="form-group">
          <label for="label-width">Label Width (inches)</label>
          <input type="number" id="label-width" name="label-width" min="0" step="0.001" placeholder="e.g., 2.500" />
        </div>
        <div class="form-group">
          <label for="label-height">Label Height (inches)</label>
          <input type="number" id="label-height" name="label-height" min="0" step="0.001" placeholder="e.g., 1.750" />
        </div>
        <div class="form-group" id="label-diameter-group" style="display:none;">
          <label for="label-diameter">Label Diameter (inches)</label>
          <input type="number" id="label-diameter" name="label-diameter" min="0" step="0.001" placeholder="e.g., 2.000" />
        </div>
      </div>

      <!-- Section: Printing -->
      <div class="section">
        <h6 class="section-title">Printing</h6>
        <div class="form-group">
          <label for="printing">Printing</label>
          <select id="printing" name="printing">
            <option value="spot-1-standard">Spot Color - 1 Standard Ink</option>
            <option value="spot-2-standard">Spot Color - 2 Standard Inks</option>
            <option value="process-digital">Process Color - Digital</option>
            <option value="white-cmyk-digital">Process Color - White + CMYK - Digital</option>
            <option value="black-only-digital">Black Ink Only - Digital</option>
          </select>
        </div>
      </div>

      <!-- Section: Material & Finish -->
      <div class="section">
        <h6 class="section-title">Material & Finish</h6>
        <div class="form-group">
          <label for="material">Material / Substrate</label>
          <select id="material" name="material">
            <option value="Semigloss Paper/Perm Adh/40# Liner">Semigloss Paper/Perm Adh/40# Liner</option>
            <option value="White Gloss BOPP/All Temp Perm Adh/40# Liner">White Gloss BOPP/All Temp Perm Adh/40# Liner</option>
          </select>
        </div>
        <div class="form-group">
          <label for="finish">Finish</label>
          <select id="finish" name="finish">
            <option value="None">None</option>
            <option value="Gloss Laminate">Gloss Laminate</option>
            <option value="Matte Laminate">Matte Laminate</option>
            <option value="Gloss Varnish">Gloss Varnish</option>
            <option value="Matte Varnish">Matte Varnish</option>
          </select>
        </div>
      </div>

      <!-- Section: Packing -->
      <div class="section">
        <h6 class="section-title">Packing</h6>
        <div class="form-group">
          <label for="format">Format</label>
          <select id="format" name="format">
            <option value="rolls">Rolls</option>
            <option value="sheets">Sheets</option>
          </select>
        </div>
        <div class="form-group">
          <label for="application-method">Application Method*</label>
          <select id="application-method" name="application-method">
            <option value="Hand Applied">Hand Applied</option>
            <option value="Machine / Auto Applied">Machine / Auto Applied</option>
          </select>
        </div>
        <div class="form-group">
          <label for="unwind-direction">Unwind Direction / Copy Position</label>
          <select id="unwind-direction" name="unwind-direction">
            <option value="1 - Top off first">1 - Top off first</option>
            <option value="2 - Bottom off first">2 - Bottom off first</option>
            <option value="3 - Right off first">3 - Right off first</option>
            <option value="4 - Left off first">4 - Left off first</option>
          </select>
        </div>
      </div>

      <!-- Section: Quantities -->
      <div class="section">
        <h6 class="section-title">Quantities</h6>
        <div class="form-group">
          <label for="versions"># of Versions / Designs</label>
          <input type="number" id="versions" name="versions" min="1" step="1" />
        </div>
        <div class="form-group">
          <label>Quantities to Quote</label>
          <div class="quantities-grid">
            <input type="number" id="quantity1" name="quantity1" min="0" step="1" placeholder="-" />
            <input type="number" id="quantity2" name="quantity2" min="0" step="1" placeholder="-" />
            <input type="number" id="quantity3" name="quantity3" min="0" step="1" placeholder="-" />
            <input type="number" id="quantity4" name="quantity4" min="0" step="1" placeholder="-" />
            <input type="number" id="quantity5" name="quantity5" min="0" step="1" placeholder="-" />
          </div>
        </div>
        <div class="form-group">
          <label>Artwork</label>
          <div style="margin-top: 6px; display: flex; gap: 16px; flex-wrap: wrap;">
            <label style="display:flex; align-items:center; gap:6px;"><input type="checkbox" name="artwork-ready" /> Artwork is ready and can be provided</label>
            <label style="display:flex; align-items:center; gap:6px;"><input type="checkbox" name="artwork-not-ready" /> Artwork is not ready yet</label>
            <label style="display:flex; align-items:center; gap:6px;"><input type="checkbox" name="artwork-recreate" /> Artwork will need to be re-created</label>
          </div>
        </div>
      </div>
    </div>

    <hr class="form-divider" />
    
    <div class="notes-section">
      <p class="form-note">* Corners - If Square Corners are chosen then any custom size up to 12&quot; x 28&quot; can be entered with no die cost.</p>
      <p class="form-note">* Existing Die Sizes - <a href="#" target="_blank" rel="noopener noreferrer">Click here to go to a die size search page</a></p>
      <p class="form-note">* Application Method - If Hand Applied is chosen, then the Unwind Direction / Copy Position / Size Orientation will be assumed to not matter, and the label orientation can be changed.</p>
      <p class="form-note">* All possible options are not shown on this page. Please contact your sales rep if you do not see the option you need.</p>
    </div>

    <hr class="form-divider" />

    <div style="margin-top: 10px;">
      <button type="button" onclick="manualSave()">Save Progress</button>
      <button type="button" onclick="downloadForm()">Save File</button>
      <button type="button" onclick="printPage()">Print</button>
      <button type="button" onclick="emailForm()">Email</button>
      <button type="button" onclick="clearForm()" style="margin-left: 30px;">Clear Form</button>
    </div>
    
  </form>

  <!-- Current Date and Time -->
  <div id="currentDateTime" style="position: fixed; bottom: 10px; right: 10px; font-size: 0.75rem; text-align: right;"></div>

  <!-- Embedded saved data for downloadable file round-trip -->
  <script id="embeddedFormData" type="application/json"></script>

  <script>
    // Mapping input names to friendly labels for email/download text
    const labelMapping = {
  "label-shape": "LabelShape",
  "cutting-die": "LabelSizeType",
      "corners": "Corners",
    "description": "Description",
  "material": "Material/Substrate",
      "label-width": "LabelWidth(in)",
      "label-height": "LabelHeight(in)",
  "finish": "Finish",
  "printing": "Printing",
  "application-method": "ApplicationMethod",
  "unwind-direction": "UnwindDirection/CopyPosition",
  "format": "Format",
  "versions": "#ofVersions/Designs",
      "quantity1": "QuantitiesToQuote1",
      "quantity2": "QuantitiesToQuote2",
      "quantity3": "QuantitiesToQuote3",
      "quantity4": "QuantitiesToQuote4",
      "quantity5": "QuantitiesToQuote5",
      "existing-die-size": "ExistingDieSize",
      "artwork-ready": "ArtworkReadyToProvide",
      "artwork-not-ready": "ArtworkNotReady",
      "artwork-recreate": "ArtworkNeedsRecreation"
    };

    function convertNameToLabel(name){
      return labelMapping[name] || name;
    }

    function autoResize(){
      this.style.height = 'auto';
      this.style.height = this.scrollHeight + 'px';
    }

    const STORAGE_KEY = "quoteFormData"; // keep data separate from order form

    function autoSave(){
      const data = {};
      document.querySelectorAll("input, textarea, select").forEach(input => {
        if (!input.name) return;
        if (input.type === "checkbox") {
          data[input.name] = input.checked;
        } else if (input.type === "file") {
          data[input.name] = input.files && input.files[0] ? input.files[0].name : "";
        } else {
          data[input.name] = input.value;
        }
      });
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    function manualSave(){
      autoSave();
    }

    function updateCurrentDateTime(){
      const now = new Date();
      const el = document.getElementById("currentDateTime");
      if (el) el.innerText = now.toLocaleString();
    }

    function loadSavedData(){
      let saved = {};
      const embedded = document.getElementById("embeddedFormData");
      if (embedded && embedded.textContent.trim()){
        try {
          saved = JSON.parse(embedded.textContent);
          localStorage.setItem(STORAGE_KEY, embedded.textContent);
        } catch(e){ saved = {}; }
      } else {
        try { saved = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); } catch(e){ saved = {}; }
      }

      // attach listeners and populate
      document.querySelectorAll("textarea").forEach(t => {
        t.addEventListener("input", autoResize);
        t.addEventListener("input", autoSave);
        if (saved[t.name] !== undefined) t.value = saved[t.name];
        autoResize.call(t);
      });
      document.querySelectorAll("input, select").forEach(inp => {
        if (inp.type !== 'file') inp.addEventListener("input", autoSave);
        if (saved[inp.name] !== undefined && inp.type !== 'file') {
          if (inp.type === 'checkbox') inp.checked = !!saved[inp.name];
          else inp.value = saved[inp.name];
        }
      });
      // Corners visibility based on shape
      const shapeSel = document.getElementById('label-shape');
      if (shapeSel) {
        shapeSel.addEventListener('change', function(){ updateCornersVisibility(); updateCircleDimensionsVisibility(); autoSave(); });
      }
      updateCornersVisibility();
      updateCircleDimensionsVisibility();
      // Existing Die Size visibility based on Label Size Type
      const sizeTypeSel = document.getElementById('cutting-die');
      if (sizeTypeSel) {
        sizeTypeSel.addEventListener('change', function(){ updateDieSizeVisibility(); updateCircleDimensionsVisibility(); autoSave(); });
      }
      updateDieSizeVisibility();
      // Hide size type/existing size when Square corners selected
      const cornersSel = document.getElementById('corners');
      if (cornersSel) {
        cornersSel.addEventListener('change', function(){ updateSizeFieldsForCorners(); autoSave(); });
      }
      updateSizeFieldsForCorners();
      // Keep width/height values synced when using diameter
      const diameterInput = document.getElementById('label-diameter');
      if (diameterInput){
        diameterInput.addEventListener('input', function(){
          const w = document.getElementById('label-width');
          const h = document.getElementById('label-height');
          if (w) w.value = this.value;
          if (h) h.value = this.value;
          autoSave();
        });
      }
      updateCurrentDateTime();
    }

    function updateCornersVisibility(){
      const shapeSel = document.getElementById('label-shape');
      const cornersGroup = document.getElementById('corners-group');
      if (!shapeSel || !cornersGroup) return;
      const val = (shapeSel.value || '').toLowerCase();
      cornersGroup.style.display = (val === 'rectangle') ? '' : 'none';
    }

    function updateDieSizeVisibility(){
      const sizeTypeSel = document.getElementById('cutting-die');
      const existingGroup = document.getElementById('existing-die-size-group');
      const widthGroup = (document.getElementById('label-width') || {}).closest ? document.getElementById('label-width').closest('.form-group') : null;
      const heightGroup = (document.getElementById('label-height') || {}).closest ? document.getElementById('label-height').closest('.form-group') : null;
      const diameterGroup = (document.getElementById('label-diameter') || {}).closest ? document.getElementById('label-diameter').closest('.form-group') : null;
      const shapeSel = document.getElementById('label-shape');
      if (!sizeTypeSel || !existingGroup) return;
      const val = (sizeTypeSel.value || '').toLowerCase();
      existingGroup.style.display = (val === 'existing-die-size') ? '' : 'none';
      const hideManualDims = (val === 'existing-die-size');
      const isCircle = (shapeSel && (shapeSel.value || '').toLowerCase() === 'circle');
      if (widthGroup) widthGroup.style.display = (hideManualDims || isCircle) ? 'none' : '';
      if (heightGroup) heightGroup.style.display = (hideManualDims || isCircle) ? 'none' : '';
      if (diameterGroup) diameterGroup.style.display = (hideManualDims || !isCircle) ? 'none' : '';
    }

    function updateSizeFieldsForCorners(){
      const shapeSel = document.getElementById('label-shape');
      const cornersSel = document.getElementById('corners');
      const sizeTypeSel = document.getElementById('cutting-die');
      const sizeTypeGroup = sizeTypeSel ? sizeTypeSel.closest('.form-group') : null;
      const existingGroup = document.getElementById('existing-die-size-group');
      const diameterGroup = (document.getElementById('label-diameter') || {}).closest ? document.getElementById('label-diameter').closest('.form-group') : null;
      const widthGroup = (document.getElementById('label-width') || {}).closest ? document.getElementById('label-width').closest('.form-group') : null;
      const heightGroup = (document.getElementById('label-height') || {}).closest ? document.getElementById('label-height').closest('.form-group') : null;
      if (!shapeSel || !cornersSel || !sizeTypeGroup || !existingGroup) return;
      const shapeVal = (shapeSel.value || '').toLowerCase();
      const cornersVal = (cornersSel.value || '').toLowerCase();
      const hideForSquareCorners = (shapeVal === 'rectangle' && cornersVal === 'square');
      sizeTypeGroup.style.display = hideForSquareCorners ? 'none' : '';
      if (hideForSquareCorners){
        existingGroup.style.display = 'none';
        if (diameterGroup) diameterGroup.style.display = 'none';
        if (widthGroup) widthGroup.style.display = '';
        if (heightGroup) heightGroup.style.display = '';
      } else {
        // Restore existing size visibility based on size type selection
        updateDieSizeVisibility();
      }
    }

    function updateCircleDimensionsVisibility(){
      const shapeSel = document.getElementById('label-shape');
      const sizeTypeSel = document.getElementById('cutting-die');
      const widthGroup = (document.getElementById('label-width') || {}).closest ? document.getElementById('label-width').closest('.form-group') : null;
      const heightGroup = (document.getElementById('label-height') || {}).closest ? document.getElementById('label-height').closest('.form-group') : null;
      const diameterGroup = (document.getElementById('label-diameter') || {}).closest ? document.getElementById('label-diameter').closest('.form-group') : null;
      if (!shapeSel || !widthGroup || !heightGroup || !diameterGroup) return;
      const isCircle = (shapeSel.value || '').toLowerCase() === 'circle';
      const hideManualDims = sizeTypeSel ? ((sizeTypeSel.value || '').toLowerCase() === 'existing-die-size') : false;
      if (isCircle){
        if (widthGroup) widthGroup.style.display = 'none';
        if (heightGroup) heightGroup.style.display = 'none';
        if (diameterGroup) diameterGroup.style.display = hideManualDims ? 'none' : '';
      } else {
        if (diameterGroup) diameterGroup.style.display = 'none';
        // show/hide width/height according to size type selection
        updateDieSizeVisibility();
      }
    }

    function clearForm(){
      if (confirm("Are you sure you want to clear the form?")){
        localStorage.removeItem(STORAGE_KEY);
        window.location.href = window.location.href;
      }
    }

    function printPage(){
      window.print();
    }

    function emailForm(){
      const elements = document.querySelectorAll("input, textarea, select, #currentDateTime");
      let body = "Here is the form data:\n\n";
      elements.forEach(el => {
        if (el.id === "currentDateTime") return;
        if (!el.name) return;
        const label = convertNameToLabel(el.name);
        let value;
        if (el.type === 'file') {
          value = (el.files && el.files[0] ? el.files[0].name : '');
        } else if (el.type === 'checkbox') {
          value = el.checked ? 'Yes' : 'No';
        } else {
          value = el.value;
        }
        body += `${label}: ${value}\n`;
      });
      body += `CurrentDateTime: ${document.getElementById("currentDateTime").innerText}\n`;
      const mailtoLink = "mailto:?subject=" + encodeURIComponent("Label Quote Form") +
                        "&body=" + encodeURIComponent(body);
      const a = document.createElement("a");
      a.href = mailtoLink;
      a.style.display = "none";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    function downloadForm(){
      autoSave();
      const saved = localStorage.getItem(STORAGE_KEY) || "{}";
      const embedded = document.getElementById("embeddedFormData");
      if (embedded) embedded.textContent = saved;
      const html = "<!DOCTYPE html>" + document.documentElement.outerHTML;
      const blob = new Blob([html], { type: "text/html" });
      const now = new Date();
      const pad = n => n.toString().padStart(2, "0");
      const fileName = `LabelQuoteForm_${now.getFullYear()}${pad(now.getMonth()+1)}${pad(now.getDate())}${pad(now.getHours())}${pad(now.getMinutes())}.html`;
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    window.onload = function(){
      loadSavedData();
      updateCurrentDateTime();
      document.querySelectorAll("button").forEach(btn => btn.addEventListener("click", updateCurrentDateTime));
    };

    function isMobileDevice(){
      return /Mobi|Android/i.test(navigator.userAgent);
    }
    if (isMobileDevice()){
      document.body.style.zoom = "200%";
    }
    
  </script>
</body>
</html>